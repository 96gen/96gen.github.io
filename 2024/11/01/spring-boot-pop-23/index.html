<!DOCTYPE html><html lang="en-us" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spring Boot project-oriented programming（23） 從零開始打造電商購物車系統：導入Redis、RabbitMQ、Docker | 96gen's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@10.5.0/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
 --light-background: url('/img/bk.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>Spring Boot project-oriented programming（23） 從零開始打造電商購物車系統：導入Redis、RabbitMQ、Docker</h1></div><hr><div id="post-content"><h2 id="Redis：提升資料讀取性能的關鍵"><a href="#Redis：提升資料讀取性能的關鍵" class="headerlink" title="Redis：提升資料讀取性能的關鍵"></a><strong>Redis：提升資料讀取性能的關鍵</strong></h2><h3 id="為何選擇-Redis"><a href="#為何選擇-Redis" class="headerlink" title="為何選擇 Redis"></a><strong>為何選擇 Redis</strong></h3><p>在專案中，如果遇到高頻讀取的資料庫查詢，資料庫讀取速度可能會成為效能瓶頸。為解決此問題，我們使用 Redis 將常用資料快取於記憶體 (RAM) 中，讓系統能直接從 Redis 讀取資料，從而減少資料庫 (MariaDB) 存取次數，有效降低延遲並增強高併發能力。</p>
<h3 id="什麼是-Redis"><a href="#什麼是-Redis" class="headerlink" title="什麼是 Redis"></a><strong>什麼是 Redis</strong></h3><p>Redis 是一款 NoSQL 資料庫，以 key-value 格式儲存資料，並將其存於 RAM 中，這使得 Redis 具有極高的讀寫速度，非常適合快取和即時存取需求。</p>
<h3 id="安裝與啟動-Redis"><a href="#安裝與啟動-Redis" class="headerlink" title="安裝與啟動 Redis"></a><strong>安裝與啟動 Redis</strong></h3><p>Redis 僅支援 Unix 和 Linux 系統，Windows 用戶可透過 Docker 安裝並執行 Redis：</p>
<h4 id="安裝步驟："><a href="#安裝步驟：" class="headerlink" title="安裝步驟："></a>安裝步驟：</h4><ol>
<li>安裝 Docker，下載網址：<a target="_blank" rel="noopener" href="https://www.docker.com/">Docker 官網</a> 。</li>
<li>安裝後啟動 Docker。</li>
<li>開啟終端機或命令提示字元，執行下載指令：  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull redis:latest<br></code></pre></td></tr></table></figure></li>
<li>使用以下指令啟動 Redis 容器：  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run --name my-redis -d redis<br></code></pre></td></tr></table></figure></li>
</ol>
<p>至此，您已安裝並啟用 Redis，可在專案中使用 Redis 進行快取。</p>
<hr>
<h2 id="專案配置-Redis-快取"><a href="#專案配置-Redis-快取" class="headerlink" title="專案配置 Redis 快取"></a><strong>專案配置 Redis 快取</strong></h2><h3 id="添加依賴"><a href="#添加依賴" class="headerlink" title="添加依賴"></a>添加依賴</h3><p>在 <code>pom.xml</code> 中引入 Redis 所需的依賴包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="配置-Redis-連線"><a href="#配置-Redis-連線" class="headerlink" title="配置 Redis 連線"></a>配置 Redis 連線</h3><p>於 <code>application.properties</code> 中設定 Redis 的主機與連結埠：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.data.redis.port</span>=<span class="hljs-string">6379</span><br><span class="hljs-attr">spring.data.redis.host</span>=<span class="hljs-string">localhost</span><br></code></pre></td></tr></table></figure>

<h3 id="Redis-快取配置"><a href="#Redis-快取配置" class="headerlink" title="Redis 快取配置"></a>Redis 快取配置</h3><p>建立 <code>Config/RedisConfig.java</code>，設定 Redis 快取所需的序列化器和快取管理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="hljs-title function_">redisTemplate</span><span class="hljs-params">(RedisConnectionFactory factory)</span> &#123;<br>        RedisTemplate&lt;String, Object&gt; redisTemplate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisTemplate</span>&lt;&gt;();<br>        redisTemplate.setConnectionFactory(factory);<br><br>        <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">objectMapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();<br>        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);<br>        objectMapper.activateDefaultTyping(LaissezFaireSubTypeValidator.instance, ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.WRAPPER_ARRAY);<br>        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, <span class="hljs-literal">false</span>);<br><br>        Jackson2JsonRedisSerializer&lt;Object&gt; serializer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jackson2JsonRedisSerializer</span>&lt;&gt;(objectMapper, Object.class);<br>        <br>        redisTemplate.setKeySerializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRedisSerializer</span>());<br>        redisTemplate.setValueSerializer(serializer);<br>        redisTemplate.afterPropertiesSet();<br><br>        <span class="hljs-keyword">return</span> redisTemplate;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> RedisCacheManager <span class="hljs-title function_">redisCacheManager</span><span class="hljs-params">(RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;<br>        <span class="hljs-type">RedisCacheWriter</span> <span class="hljs-variable">writer</span> <span class="hljs-operator">=</span> RedisCacheWriter.nonLockingRedisCacheWriter(redisTemplate.getConnectionFactory());<br>        <span class="hljs-type">RedisCacheConfiguration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> RedisCacheConfiguration.defaultCacheConfig()<br>            .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(redisTemplate.getValueSerializer()));<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisCacheManager</span>(writer, config);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="資料快取管理"><a href="#資料快取管理" class="headerlink" title="資料快取管理"></a><strong>資料快取管理</strong></h2><h3 id="UserService-快取應用"><a href="#UserService-快取應用" class="headerlink" title="UserService 快取應用"></a>UserService 快取應用</h3><p>在 <code>Service/UserService.java</code> 中快取用戶資料，若快取命中則直接返回，否則讀取資料庫並存入快取，並設置隨機過期時間 (30-39 分鐘) 以避免集體失效：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> RedisTemplate&lt;String, Object&gt; redisTemplate;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">USER_CACHE_MINUTES</span> <span class="hljs-operator">=</span> <span class="hljs-number">30</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(UserRepository userRepository, RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;<br>        <span class="hljs-built_in">this</span>.redisTemplate = redisTemplate;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">findUserByEmail</span><span class="hljs-params">(String email)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;user:email:&quot;</span> + email;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">cachedUser</span> <span class="hljs-operator">=</span> (User) redisTemplate.opsForValue().get(cacheKey);<br>        <span class="hljs-keyword">if</span> (cachedUser != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> cachedUser;<br>        &#125;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userRepository.findByEmail(email);<br>        <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) &#123;<br>            redisTemplate.opsForValue().set(cacheKey, user, USER_CACHE_MINUTES + <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>().nextInt(<span class="hljs-number">10</span>), TimeUnit.MINUTES);<br>        &#125;<br>        <span class="hljs-keyword">return</span> user;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="ProductService-快取應用"><a href="#ProductService-快取應用" class="headerlink" title="ProductService 快取應用"></a>ProductService 快取應用</h3><p>在 <code>Service/ProductService.java</code> 中，產品資料快取並處理刪除操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductService</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> RedisTemplate&lt;String, Object&gt; redisTemplate;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PRODUCT_CACHE_MINUTES</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ProductService</span><span class="hljs-params">(ProductRepository productRepository, RedisTemplate&lt;String, Object&gt; redisTemplate)</span> &#123;<br>        <span class="hljs-built_in">this</span>.redisTemplate = redisTemplate;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">deleteProduct</span><span class="hljs-params">(Long id)</span> &#123;<br>        productRepository.deleteById(id);<br>        redisTemplate.delete(<span class="hljs-string">&quot;product:&quot;</span> + id);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Product deleted successfully&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductById</span><span class="hljs-params">(Long id)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;product:&quot;</span> + id;<br>        <span class="hljs-type">Product</span> <span class="hljs-variable">cachedProduct</span> <span class="hljs-operator">=</span> (Product) redisTemplate.opsForValue().get(cacheKey);<br>        <span class="hljs-keyword">if</span> (cachedProduct != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> cachedProduct;<br>        &#125;<br>        Optional&lt;Product&gt; productOpt = productRepository.findById(id);<br>        <span class="hljs-keyword">if</span> (productOpt.isPresent()) &#123;<br>            <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> productOpt.get();<br>            redisTemplate.opsForValue().set(cacheKey, product, PRODUCT_CACHE_MINUTES + <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>().nextInt(<span class="hljs-number">3</span>), TimeUnit.MINUTES);<br>            <span class="hljs-keyword">return</span> product;<br>        &#125;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exception</span>(<span class="hljs-string">&quot;Product not found&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="RabbitMQ-使用指南"><a href="#RabbitMQ-使用指南" class="headerlink" title="RabbitMQ 使用指南"></a><strong>RabbitMQ 使用指南</strong></h2><h3 id="什麼是-RabbitMQ"><a href="#什麼是-RabbitMQ" class="headerlink" title="什麼是 RabbitMQ"></a><strong>什麼是 RabbitMQ</strong></h3><p>RabbitMQ 是一個訊息代理，負責將訊息傳遞到 Queue（訊息佇列），並依設定將其轉發給消費者（Consumers）。可透過不同類型的 Exchanges（交換器）靈活的路由訊息到指定 Queue。</p>
<h3 id="為什麼使用-RabbitMQ"><a href="#為什麼使用-RabbitMQ" class="headerlink" title="為什麼使用 RabbitMQ"></a><strong>為什麼使用 RabbitMQ</strong></h3><p>耗時操作會影響系統回應速度，例如在用戶註冊後發送 Email。若無 RabbitMQ，需等待 Email 發送完才能繼續操作，影響體驗。加入 RabbitMQ 後，這類操作可轉移至 Queue 中，由消費者非同步處理，避免系統阻塞，用戶可立即繼續操作。</p>
<h3 id="RabbitMQ-安裝"><a href="#RabbitMQ-安裝" class="headerlink" title="RabbitMQ 安裝"></a><strong>RabbitMQ 安裝</strong></h3><p>推薦使用 Docker 安裝：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -it --<span class="hljs-built_in">rm</span> --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:4-management<br></code></pre></td></tr></table></figure>

<h3 id="專案導入-Email-和-RabbitMQ"><a href="#專案導入-Email-和-RabbitMQ" class="headerlink" title="專案導入 Email 和 RabbitMQ"></a><strong>專案導入 Email 和 RabbitMQ</strong></h3><p>在 <code>pom.xml</code> 中加入 Mail 和 AMQP 依賴：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="設定-application-properties"><a href="#設定-application-properties" class="headerlink" title="設定 application.properties"></a>設定 <code>application.properties</code></h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.mail.host</span>=<span class="hljs-string">smtp.gmail.com</span><br><span class="hljs-attr">spring.mail.port</span>=<span class="hljs-string">587</span><br><span class="hljs-attr">spring.mail.username</span>=<span class="hljs-string">$&#123;GMAIL_ADDRESS&#125;</span><br><span class="hljs-attr">spring.mail.password</span>=<span class="hljs-string">$&#123;GMAIL_PASSWORD&#125;</span><br><span class="hljs-attr">spring.mail.properties.mail.smtp.auth</span>=<span class="hljs-string">true</span><br><span class="hljs-attr">spring.mail.properties.mail.smtp.starttls.enable</span>=<span class="hljs-string">true</span><br><br><span class="hljs-attr">spring.rabbitmq.host</span>=<span class="hljs-string">localhost</span><br><span class="hljs-attr">spring.rabbitmq.port</span>=<span class="hljs-string">5672</span><br><span class="hljs-attr">spring.rabbitmq.username</span>=<span class="hljs-string">guest</span><br><span class="hljs-attr">spring.rabbitmq.password</span>=<span class="hljs-string">guest</span><br></code></pre></td></tr></table></figure>

<p>取得應用程式密碼：至 Google 帳戶 -&gt; 安全性 -&gt; 開啟兩步驟驗證 -&gt; 應用程式密碼。</p>
<p>將密碼設定 <code>.env</code> 中的 GMAIL_PASSWORD。</p>
<h3 id="RabbitMQ-配置"><a href="#RabbitMQ-配置" class="headerlink" title="RabbitMQ 配置"></a><strong>RabbitMQ 配置</strong></h3><p>建立 <code>RabbitMQConfig.java</code>，配置 Queue 和 Exchange：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitMQConfig</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;emailQueue&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">EXCHANGE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;emailExchange&quot;</span>;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">queue</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(QUEUE_NAME, <span class="hljs-literal">true</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> TopicExchange <span class="hljs-title function_">exchange</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TopicExchange</span>(EXCHANGE_NAME);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">binding</span><span class="hljs-params">(Queue queue, TopicExchange exchange)</span> &#123;<br>        <span class="hljs-keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="hljs-string">&quot;email.routing.key&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="建立消費者-EmailConsumer"><a href="#建立消費者-EmailConsumer" class="headerlink" title="建立消費者 EmailConsumer"></a><strong>建立消費者 EmailConsumer</strong></h3><p>在 <code>EmailConsumer.java</code> 中設置消費者接收 Queue 訊息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailConsumer</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EmailService emailService;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">EmailConsumer</span><span class="hljs-params">(EmailService emailService)</span> &#123;<br>        <span class="hljs-built_in">this</span>.emailService = emailService;<br>    &#125;<br><br>    <span class="hljs-meta">@RabbitListener(queues = RabbitMQConfig.QUEUE_NAME)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receiveMessage</span><span class="hljs-params">(String to)</span> &#123;<br>        emailService.sendSimpleEmail(to);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="發送-Email"><a href="#發送-Email" class="headerlink" title="發送 Email"></a><strong>發送 Email</strong></h3><p>在 <code>EmailService.java</code> 中實現發送 Email 功能：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailService</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JavaMailSender javaMailSender;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">EmailService</span><span class="hljs-params">(JavaMailSender javaMailSender)</span> &#123;<br>        <span class="hljs-built_in">this</span>.javaMailSender = javaMailSender;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendSimpleEmail</span><span class="hljs-params">(String to)</span> &#123;<br>        <span class="hljs-type">Dotenv</span> <span class="hljs-variable">dotenv</span> <span class="hljs-operator">=</span> Dotenv.load();<br>        <span class="hljs-type">SimpleMailMessage</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleMailMessage</span>();<br>        message.setTo(to);<br>        message.setSubject(<span class="hljs-string">&quot;Welcome to Shopping Cart, &quot;</span> + to + <span class="hljs-string">&quot; !&quot;</span>);<br>        message.setText(<span class="hljs-string">&quot;Thank you for choosing Shopping Cart. We look forward to serving you and making your shopping experience enjoyable.\n&quot;</span> +<br>                        <span class="hljs-string">&quot;Best regards,\n&quot;</span> +<br>                        <span class="hljs-string">&quot;The Shopping Cart Team&quot;</span>);<br>        message.setFrom(dotenv.get(<span class="hljs-string">&quot;GMAIL_ADDRESS&quot;</span>));<br>        javaMailSender.send(message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="在-UserService-中使用-RabbitMQ-發送-Email"><a href="#在-UserService-中使用-RabbitMQ-發送-Email" class="headerlink" title="在 UserService 中使用 RabbitMQ 發送 Email"></a><strong>在 UserService 中使用 RabbitMQ 發送 Email</strong></h3><p>在 <code>UserService.java</code> 中註冊成功時，將 Email 發送請求傳送到對應的 Queue：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> RabbitTemplate rabbitTemplate;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(RabbitTemplate rabbitTemplate)</span> &#123;<br>        <span class="hljs-built_in">this</span>.rabbitTemplate = rabbitTemplate;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createUser</span><span class="hljs-params">(User user)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">if</span> (userRepository.findByEmail(user.getEmail()) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exception</span>(<span class="hljs-string">&quot;Error: Email is already registered.&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-type">User</span> <span class="hljs-variable">createdUser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        createdUser.setEmail(user.getEmail());<br>        createdUser.setPassword(passwordEncoder.encode(user.getPassword()));<br>        sendEmail(user.getEmail());<br>        userRepository.save(createdUser);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendEmail</span><span class="hljs-params">(String to)</span> &#123;<br>        rabbitTemplate.convertAndSend(RabbitMQConfig.EXCHANGE_NAME, <span class="hljs-string">&quot;email.routing.key&quot;</span>, to);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用 RabbitMQ 後，系統反應更即時。</p>
<hr>
<h2 id="Docker-一鍵部署專案"><a href="#Docker-一鍵部署專案" class="headerlink" title="Docker 一鍵部署專案"></a><strong>Docker 一鍵部署專案</strong></h2><p>安裝 MariaDB、Redis 和 RabbitMQ 有時會讓人感到繁瑣。現在，我們可以使用 Docker 將所有環境設定、編譯和啟動自動化，讓專案的部署只需一行命令。</p>
<p>只需準備好專案原始碼和 <code>.env</code> 檔案，在專案根目錄添加 <code>docker-compose.yml</code> 和 <code>Dockerfile</code>，即可自動完成部署。</p>
<h3 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h3><p>首先編寫 <code>docker-compose.yml</code>，用於配置 MariaDB、Redis、RabbitMQ 的環境。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">db:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mariadb:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">mariadb_cart</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">MARIADB_ROOT_PASSWORD:</span> <span class="hljs-number">12345678</span><br>      <span class="hljs-attr">MARIADB_DATABASE:</span> <span class="hljs-string">cart_db</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3306:3306&quot;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">db_data:/var/lib/mysql</span><br><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:latest</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">redis_cart</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;6379:6379&quot;</span><br><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">rabbitmq:4-management</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">rabbitmq_cart</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;5672:5672&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;15672:15672&quot;</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">RABBITMQ_DEFAULT_USER:</span> <span class="hljs-string">guest</span><br>      <span class="hljs-attr">RABBITMQ_DEFAULT_PASS:</span> <span class="hljs-string">guest</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">rabbitmq_data:/var/lib/rabbitmq</span><br><br>  <span class="hljs-attr">app:</span><br>    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">java_cart</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8080:8080&quot;</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">SPRING_DATASOURCE_URL:</span> <span class="hljs-string">jdbc:mariadb://db:3306/cart_db</span><br>      <span class="hljs-attr">SPRING_DATASOURCE_USERNAME:</span> <span class="hljs-string">root</span><br>      <span class="hljs-attr">SPRING_DATASOURCE_PASSWORD:</span> <span class="hljs-number">12345678</span><br>      <span class="hljs-attr">SPRING_DATA_REDIS_HOST:</span> <span class="hljs-string">redis</span><br>      <span class="hljs-attr">SPRING_RABBITMQ_HOST:</span> <span class="hljs-string">rabbitmq</span><br><br><span class="hljs-attr">volumes:</span><br>  <span class="hljs-attr">db_data:</span><br>  <span class="hljs-attr">rabbitmq_data:</span><br></code></pre></td></tr></table></figure>

<h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><p>接著，編寫 <code>Dockerfile</code>，設定自動編譯並執行 Spring Boot 應用程式。</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> maven:<span class="hljs-number">3</span>-amazoncorretto-<span class="hljs-number">17</span> AS build<br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> . /app</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> mvn clean package -DskipTests</span><br><br><span class="hljs-keyword">FROM</span> amazoncorretto:<span class="hljs-number">17</span>-alpine<br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> --from=build /app/target/*.jar app.jar</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> ./.env .<span class="hljs-built_in">env</span></span><br><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8080</span><br><br><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;app.jar&quot;</span>]</span><br></code></pre></td></tr></table></figure>

<p>使用以下指令即可啟動環境並部署專案：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose up<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="JMeter-壓力測試"><a href="#JMeter-壓力測試" class="headerlink" title="JMeter 壓力測試"></a>JMeter 壓力測試</h2><p>使用 JMeter 進行高併發專案的性能測試。</p>
<p>設定了 1000 並發數量，執行四種請求（Get Product By Filter、Get User Cart、Add To Cart、Find Order），重複三次，共計 12,000 個請求，對專案的處理能力是極大挑戰。</p>
<p class='item-img' data-src='https://images2.imgbox.com/cf/85/G7MpehmH_o.png'><img src="https://images2.imgbox.com/cf/85/G7MpehmH_o.png"></p>
<p>測試結果顯示，最高延遲為 2845 毫秒。這在如此高壓下依然不錯，且達到 100% 成功率，沒有任何錯誤。</p>
<p class='item-img' data-src='https://images2.imgbox.com/9b/72/5S371PAc_o.png'><img src="https://images2.imgbox.com/9b/72/5S371PAc_o.png"></p>
<p>最低延遲僅 5 毫秒，表現出色。</p>
<p class='item-img' data-src='https://images2.imgbox.com/58/77/TjtPYE9F_o.png'><img src="https://images2.imgbox.com/58/77/TjtPYE9F_o.png"></p>
<p>高併發專案成功通過壓力測試，證明其在 17 秒內承受 12,000 個請求的高併發處理能力。</p>
<p>完整程式碼可以前往<a target="_blank" rel="noopener" href="https://github.com/96gen/shopping_cart_project">觀看</a></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2024/11/02/spring-boot-pop-24/">← Next Spring Boot project-oriented programming（24）在Spring Boot導入Ollama完成AI</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2024/10/31/spring-boot-pop-22/">Spring Boot project-oriented programming（22） 從零開始打造電商購物車系統：串接Stripe API支付與使用SSL Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/img/faction/6.png" alt="Logo"></a><h1 id="Dr"><a href="/">96gen</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis%EF%BC%9A%E6%8F%90%E5%8D%87%E8%B3%87%E6%96%99%E8%AE%80%E5%8F%96%E6%80%A7%E8%83%BD%E7%9A%84%E9%97%9C%E9%8D%B5"><span class="toc-number">1.</span> <span class="toc-text">Redis：提升資料讀取性能的關鍵</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%BA%E4%BD%95%E9%81%B8%E6%93%87-Redis"><span class="toc-number">1.1.</span> <span class="toc-text">為何選擇 Redis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF-Redis"><span class="toc-number">1.2.</span> <span class="toc-text">什麼是 Redis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D%E8%88%87%E5%95%9F%E5%8B%95-Redis"><span class="toc-number">1.3.</span> <span class="toc-text">安裝與啟動 Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D%E6%AD%A5%E9%A9%9F%EF%BC%9A"><span class="toc-number">1.3.1.</span> <span class="toc-text">安裝步驟：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%88%E6%A1%88%E9%85%8D%E7%BD%AE-Redis-%E5%BF%AB%E5%8F%96"><span class="toc-number">2.</span> <span class="toc-text">專案配置 Redis 快取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B3%B4"><span class="toc-number">2.1.</span> <span class="toc-text">添加依賴</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-Redis-%E9%80%A3%E7%B7%9A"><span class="toc-number">2.2.</span> <span class="toc-text">配置 Redis 連線</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E5%BF%AB%E5%8F%96%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.</span> <span class="toc-text">Redis 快取配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B3%87%E6%96%99%E5%BF%AB%E5%8F%96%E7%AE%A1%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">資料快取管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UserService-%E5%BF%AB%E5%8F%96%E6%87%89%E7%94%A8"><span class="toc-number">3.1.</span> <span class="toc-text">UserService 快取應用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProductService-%E5%BF%AB%E5%8F%96%E6%87%89%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">ProductService 快取應用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RabbitMQ-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97"><span class="toc-number">4.</span> <span class="toc-text">RabbitMQ 使用指南</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF-RabbitMQ"><span class="toc-number">4.1.</span> <span class="toc-text">什麼是 RabbitMQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%BA%E4%BB%80%E9%BA%BC%E4%BD%BF%E7%94%A8-RabbitMQ"><span class="toc-number">4.2.</span> <span class="toc-text">為什麼使用 RabbitMQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-%E5%AE%89%E8%A3%9D"><span class="toc-number">4.3.</span> <span class="toc-text">RabbitMQ 安裝</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%88%E6%A1%88%E5%B0%8E%E5%85%A5-Email-%E5%92%8C-RabbitMQ"><span class="toc-number">4.4.</span> <span class="toc-text">專案導入 Email 和 RabbitMQ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A8%AD%E5%AE%9A-application-properties"><span class="toc-number">4.5.</span> <span class="toc-text">設定 application.properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ-%E9%85%8D%E7%BD%AE"><span class="toc-number">4.6.</span> <span class="toc-text">RabbitMQ 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E6%B6%88%E8%B2%BB%E8%80%85-EmailConsumer"><span class="toc-number">4.7.</span> <span class="toc-text">建立消費者 EmailConsumer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BC%E9%80%81-Email"><span class="toc-number">4.8.</span> <span class="toc-text">發送 Email</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8-UserService-%E4%B8%AD%E4%BD%BF%E7%94%A8-RabbitMQ-%E7%99%BC%E9%80%81-Email"><span class="toc-number">4.9.</span> <span class="toc-text">在 UserService 中使用 RabbitMQ 發送 Email</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E4%B8%80%E9%8D%B5%E9%83%A8%E7%BD%B2%E5%B0%88%E6%A1%88"><span class="toc-number">5.</span> <span class="toc-text">Docker 一鍵部署專案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-yml"><span class="toc-number">5.1.</span> <span class="toc-text">docker-compose.yml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dockerfile"><span class="toc-number">5.2.</span> <span class="toc-text">Dockerfile</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JMeter-%E5%A3%93%E5%8A%9B%E6%B8%AC%E8%A9%A6"><span class="toc-number">6.</span> <span class="toc-text">JMeter 壓力測試</span></a></li></ol></div></div><footer><nobr><span class="icp-title">copyright</span><a class="icp-content" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a></nobr><br><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>